{
  Key parsed=Key.make("prostate_parsed");
  Key modelKey=Key.make("prostate_model");
  GLMModel model=null;
  File f=TestUtil.find_test_file("smalldata/glm_test/prostate_cat_replaced.csv");
  Frame fr=getFrameForFile(parsed,"smalldata/glm_test/prostate_cat_replaced.csv",new String[]{"ID"},"CAPSULE");
  fr.remove("RACE");
  Key k=Key.make("rebalanced");
  H2O.submitTask(new RebalanceDataSet(fr,k,64)).join();
  fr.delete();
  fr=DKV.get(k).get();
  Frame tr=DMatrix.transpose(fr);
  tr.reloadVecs();
  Key kk=Key.make("transposed");
  DKV.put(kk,new Frame(kk,tr.names(),tr.vecs()));
  for (int i=0; i < fr.numRows(); ++i)   for (int j=0; j < fr.numCols(); ++j)   assertEquals(fr.vec(j).at(i),tr.vec(i).at(j),1e-4);
  fr.delete();
  Futures fs=new Futures();
  for (  Vec v : tr.vecs())   v.remove(fs);
}
