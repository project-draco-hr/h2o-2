{
  if (keys.length > 1)   throw H2O.unimpl();
  Value dataset=DKV.get(keys[0]);
  if (dataset.isHex())   throw new IllegalArgumentException("This is a binary structured dataset; " + "parse() only works on text files.");
  try {
    try {
      parseUncompressed(job,dataset,CustomParser.Type.XLS,setup);
      return;
    }
 catch (    Exception e) {
    }
    Compression compression=guessCompressionMethod(dataset);
    if (compression == Compression.ZIP) {
      try {
        parseUncompressed(job,dataset,CustomParser.Type.XLSX,setup);
        return;
      }
 catch (      Exception e) {
      }
    }
switch (compression) {
case NONE:
      parseUncompressed(job,dataset,CustomParser.Type.CSV,setup);
    break;
case ZIP:
  parseZipped(job,dataset,setup);
break;
case GZIP:
parseGZipped(job,dataset,setup);
break;
default :
throw new Error("Unknown compression of dataset!");
}
}
 catch (java.io.EOFException eof) {
UKV.put(job.dest(),new Fail(eof.getMessage()));
}
catch (Exception e) {
UKV.put(job.dest(),new Fail(e.getMessage()));
throw Throwables.propagate(e);
}
 finally {
job.remove();
}
}
