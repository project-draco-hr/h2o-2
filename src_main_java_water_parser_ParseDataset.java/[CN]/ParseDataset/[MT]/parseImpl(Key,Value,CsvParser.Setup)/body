{
  if (dataset.isHex())   throw new IllegalArgumentException("This is a binary structured dataset; " + "parse() only works on text files.");
  try {
    try {
      parseUncompressed(result,dataset,CustomParser.Type.XLS,setup);
      return;
    }
 catch (    Exception e) {
    }
    Compression compression=guessCompressionMethod(dataset);
    if (compression == Compression.ZIP) {
      try {
        parseUncompressed(result,dataset,CustomParser.Type.XLSX,setup);
        return;
      }
 catch (      Exception e) {
      }
    }
switch (compression) {
case NONE:
      parseUncompressed(result,dataset,CustomParser.Type.CSV,setup);
    break;
case ZIP:
  parseZipped(result,dataset,setup);
break;
case GZIP:
parseGZipped(result,dataset,setup);
break;
default :
throw new Error("Unknown compression of dataset!");
}
}
 catch (Exception e) {
ParseStatus.error(result,e.getMessage());
throw Throwables.propagate(e);
}
}
