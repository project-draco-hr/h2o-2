{
  parseArgs(args);
  Configuration conf=getConf();
  String mapChildJavaOpts="-Xms" + mapperXmx + " -Xmx"+ mapperXmx;
  conf.set("mapred.child.java.opts",mapChildJavaOpts);
  conf.set("mapred.map.child.java.opts",mapChildJavaOpts);
  conf.set("mapred.used.genericoptionsparser","true");
  conf.set("mapreduce.map.speculative","false");
  conf.set("mapred.map.tasks.speculative.execution","false");
  conf.set("mapred.map.max.attempts","1");
  conf.set("mapred.job.reuse.jvm.num.tasks","1");
  conf.set("hexdata.jobtrackername",jobtrackerName);
  Job job=new Job(conf,jobtrackerName);
  job.setJarByClass(getClass());
  job.setInputFormatClass(H2OInputFormat.class);
  job.setMapperClass(h2omapper.class);
  job.setNumReduceTasks(0);
  job.setOutputKeyClass(Text.class);
  job.setOutputValueClass(Text.class);
  FileInputFormat.addInputPath(job,new Path("ignored"));
  if (outputPath != null) {
    FileOutputFormat.setOutputPath(job,new Path(outputPath));
  }
  System.out.println("Job running (this command blocks until the H2O cluster shuts down)...");
  boolean success=job.waitForCompletion(true);
  if (!success) {
    return 1;
  }
  return 0;
}
