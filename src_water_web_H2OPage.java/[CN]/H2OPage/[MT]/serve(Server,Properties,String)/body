{
  String username=sessionID != null ? Server._sessionManager.authenticate(sessionID) : null;
  RString response=new RString(html);
  response.replace("navbar",navbar);
  if (username != null)   response.replace("footer","You are logged as " + username + ". <a href=\"logoff\">Logoff</a>");
  try {
    String result=serveImpl(server,args,sessionID);
    if (result == null)     return result;
    if (_refresh != 0)     response.replace("refresh","<META HTTP-EQUIV='refresh' CONTENT='" + _refresh + "'>");
    StringBuilder additions=new StringBuilder();
    for (    String script : additionalScripts()) {
      additions.append("<script src='");
      additions.append(script);
      additions.append("'></script>");
    }
    response.replace("scripts",additions.toString());
    additions.setLength(0);
    for (    String style : additionalStyles()) {
      additions.append("<link href='");
      additions.append(style);
      additions.append("' rel='stylesheet'>");
    }
    response.replace("styles",additions.toString());
    response.replace("contents",result);
  }
 catch (  PageError e) {
    response.replace("contents",e.getMessage());
  }
  return response.toString();
}
