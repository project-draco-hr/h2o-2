{
  for (  char separator : SEPARATORS) {
    StringBuilder sb=new StringBuilder();
    for (int i=0; i < 50; i++)     sb.append("0.0\n");
    sb.append("1.0\n");
    for (int i=0; i < 50; i++)     sb.append("0.0\n");
    Key k=FVecTest.makeByteVec(Key.make().toString(),sb.toString());
    Key r1=Key.make("r1");
    ParseDataset2.parse(r1,new Key[]{k});
    double[][] exp=new double[101][1];
    exp[50][0]=1;
    testParsed(r1,exp,k);
    sb=new StringBuilder();
    for (int i=0; i < 50; i++)     sb.append("0\n");
    sb.append("2\n");
    for (int i=0; i < 50; i++)     sb.append("0\n");
    k=FVecTest.makeByteVec(Key.make().toString(),sb.toString());
    r1=Key.make("r1");
    ParseDataset2.parse(r1,new Key[]{k});
    exp=new double[101][1];
    exp[50][0]=2;
    testParsed(r1,exp,k);
    sb=new StringBuilder();
    for (int i=0; i < 50; i++)     sb.append("0,0\n");
    sb.append("2,3\n");
    for (int i=0; i < 49; i++)     sb.append("0,0\n");
    sb.append("0");
    k=FVecTest.makeByteVec(Key.make().toString(),sb.toString());
    r1=Key.make("r1");
    ParseDataset2.parse(r1,new Key[]{k});
    exp=new double[101][2];
    exp[50][0]=2;
    exp[50][1]=2;
    exp[100][0]=0;
    exp[101][0]=Double.NaN;
    testParsed(r1,exp,k);
  }
}
