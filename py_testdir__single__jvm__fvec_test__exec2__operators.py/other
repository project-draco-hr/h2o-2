import unittest, random, sys, time
sys.path.extend(['.', '..', 'py'])
import h2o, h2o_browse as h2b, h2o_exec as h2e, h2o_hosts, h2o_import as h2i
print 'FIX!: need to test the && and || reduction operators'
initList = [('r.1', 'r.1=i.hex'), ('r.1', 'r.1=i.hex'), ('r2.hex', 'r2.hex=i.hex'), ('r3.hex', 'r3.hex=i.hex')]
deepIfElse = ''
closeParen = 0
for i in range(20):
    deepIfElse += 'ifelse(1,0,'
    deepIfElse += 'ifelse(0,1,'
    closeParen += 1
deepIfElse += '0'
for i in range(closeParen):
    deepIfElse += '))'
exprListFull = [deepIfElse, 'apply(r.1, 2, function(x) { mean(x) })', 'apply(r.1, 2, function(x) { sd(x) })', 'apply(r.1, 2, function(x) { sd(x)/mean(x) })', 'ddply(r.1,c(3),nrow)', 'ddply(r.1,c(3),function(x) {c(mean(x[,2]),mean(x[,3]))})', 'ddply(r.1,c(7),nrow)', 's1=c(1); s2=c(2); s3=c(3); s4=c(4); s5=s1+s2+s3+s4;s.hex = r.1[!is.na(r.1[,13]),]', 'apply(r.1,2,function(x){total=sum(ifelse(is.na(x),0,x)); rcnt=nrow(x)-sum(is.na(x)); mean=total / rcnt; ifelse(is.na(x),mean,x)})', 's.hex = r.1[!is.na(r.1[,13]),]', 'r.1=apply(r.1,2,function(x){ifelse(is.na(x),0,x)})', 'cct.hex=runif(r.1);rTrain=r.1[cct.hex<=0.9,];rTest=r.1[cct.hex>0.9,]', 'r.1[,1]=r.1[,1]==1.0', 'b.hex=runif(r3.hex[,1])', 'b.hex=runif(r3.hex[1,])', '1.23', '1.23e0<2.34e1', '+1.23e0<+2.34e1', '-1.23e0<+-2.34e1', '-1.23e000<+-2.34e100', '-1.23e-001<+-2.34e-100', '1.23<2.34', '1.23<=2.34', '1.23>2.34', '1.23>=2.34', '1.23==2.34', '1.23!=2.34', '1.23 <2.34', '1.23 <=2.34', '1.23 >2.34', '1.23 >=2.34', '1.23 ==2.34', '1.23 !=2.34', '1.23< 2.34', '1.23<= 2.34', '1.23> 2.34', '1.23>= 2.34', '1.23== 2.34', '1.23!= 2.34', 'r.1', 'r.1[2,3]', 'r.1[2+4,-4]', 'r.1[1,-1]; r.1[1,-1]; r.1[1,-1]', 'r.1[1,]', 'r.1[,1]', 'r.1+1', 'r.1-r.1', '1.23+(r.1-r.1)', '(1.23+r.1)-r.1', 'min(r.1,1+2)', 'is.na(r.1)', 'nrow(r.1)*3', 'r.1[nrow(r.1)-1,ncol(r.1)-1]', 'x=0; x+2', 'x=1', 'x<-1', 'a=r.1', 'r.1[nrow(r.1),]', 'r.1[,ncol(r.1)]', 'c(1,3,5)', 'function(x,y,z){x[]}(r.1,1,2)', 'function(x){x+1}(2)', 'function(x){y=x*2; y+1}(2)', 'function(x){y=1+2}(2)', 'sum(1,2,3)', 'sum(c(1,3,5))', 'sum(4,c(1,3,5),2,6)', 'sum(1,r.1,3)', 'r.1[,c(1)]', 'r.1[c(1),]', 'r.1[c(1,3,5),]', 'r.1[,c(1,3,5)]', 'a=c(11,22,33,44,55,66); a[c(2,6,1),]', 'a=1;a=2;function(x){x=a;a=3}', 'a=r.1;function(x){x=a;a=3;nrow(x)*a}(a)', 'function(funy){function(x){funy(x)*funy(x)}}(sgn)(-2)', 'r.1[r.1[,1]>4,]', 'apply(r.1,2,sum)', 'mean=function(x){apply(x,2,sum)/nrow(x)};mean(r.1)', 'ifelse(0,1,2)', 'ifelse(0,r.1+1,r.1+2)', 'ifelse(r.1>3,99,r.1)', 'ifelse(0,+,*)(1,2)', '(0 ? + : *)(1,2)', '(1? r.1 : (r.1+1))[1,2]', 'factor(r.1[,5])', 'r.1[,1]', 'r.1[1,]', 'r.1[,1]+1', 'r.1[1,]+1', 'r.1[,1]=3.3;r.1', 'r.1[,1]=r.1[,1]+1', 'r.1[,ncol(r.1)+1]=4', 'a=ncol(r.1); r.1[,c(a+1,a+2)]=5', 'a=0;x=0', 'a=c(1,2,3); a[a[,1]>1,1]', 'z.hex=a=c(1,2,3); a[a[,1]>1,1]']
if (1 == 0):
    exprList = []
    for i in range(10):
        expr = ''
        for j in range(1):
            expr += (('z.hex=' + random.choice(exprListFull)) + ';')
        exprList.append(expr)
exprList = exprListFull
if (__name__ == '__main__'):
    h2o.unit_main()
