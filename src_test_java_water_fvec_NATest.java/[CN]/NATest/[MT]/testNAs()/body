{
  File file=find_test_file("./smalldata/test/na_test.zip");
  Key key=NFSFileVec.make(file);
  Key okey=Key.make("na_test.hex");
  Frame fr=ParseDataset2.parse(okey,new Key[]{key});
  int nlines=(int)fr._vecs[0].length();
  Class[] expectedTypes=new Class[]{C1Chunk.class,C1SChunk.class,C2Chunk.class,C2SChunk.class,C4Chunk.class,C4FChunk.class,C8Chunk.class,C8DChunk.class};
  assertTrue(fr._vecs.length == expectedTypes.length);
  for (int i=0; i < expectedTypes.length; ++i)   assertTrue(expectedTypes[i].isInstance(fr._vecs[i].elem2BV(0)));
  assertEquals(8,nlines);
  for (int i=0; i < nlines - 1; ++i) {
    for (    Vec v : fr._vecs) {
      assertTrue("error at line " + i + ", vec "+ v.elem2BV(0).getClass().getSimpleName(),!v.isNA(v.at(i)) && !v.isNA(v.at8(i)));
    }
  }
  for (  Vec v : fr._vecs) {
    assertTrue(v.isNA(v.at(nlines - 1)) && v.isNA(v.at8(nlines - 1)));
    v.replaceNAs(1.0,2);
    assertTrue(!v.isNA(v.at(nlines - 1)) && !v.isNA(v.at8(nlines - 1)));
    assertTrue(v.at(nlines - 1) == 1.0 && v.at8(nlines - 1) == 2);
    v.setNAs(3.0,4);
    assertTrue(v.isNA(v.at(nlines - 1)) && v.isNA(v.at8(nlines - 1)));
    assertTrue(v.at(nlines - 1) == 3.0 && v.at8(nlines - 1) == 4);
  }
  UKV.remove(key);
  UKV.remove(okey);
}
