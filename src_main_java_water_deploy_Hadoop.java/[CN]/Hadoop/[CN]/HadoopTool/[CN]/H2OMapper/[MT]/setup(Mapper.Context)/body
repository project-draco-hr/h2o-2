{
  try {
    String hosts="";
    String port=context.getConfiguration().get(PORT_KEY);
    for (    String host : context.getConfiguration().get(HOSTS_KEY).split(","))     hosts+=host + ":" + port+ '\n';
    File flat=Utils.tempFile(hosts);
    Boot.main(new String[]{"-name","hadoop","-port",port,"-flatfile",flat.getAbsolutePath()});
    for (; ; ) {
      context.progress();
      Thread.sleep(10000);
    }
  }
 catch (  Exception ex) {
    throw new RuntimeException(ex);
  }
}
