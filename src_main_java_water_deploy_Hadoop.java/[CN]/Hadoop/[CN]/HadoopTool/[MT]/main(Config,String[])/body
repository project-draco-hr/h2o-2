{
  System.setProperty("HADOOP_USER_NAME",config.user);
  Configuration conf=new Configuration();
  conf.set("fs.default.name",config.name_server);
  conf.set("mapred.job.tracker",config.tracker);
  conf.set("mapreduce.framework.name","classic");
  conf.setInt("mapred.tasktracker.map.tasks.maximum",1);
  conf.set("mapred.jar","/home/cypof/h2o/target/h2o.jar");
  conf.set("mapred.child.java.opts","-Xms256m -Xmx2g -XX:+UseSerialGC");
  conf.set("mapred.job.map.memory.mb","4096");
  conf.set("mapred.job.reduce.memory.mb","1024");
  String hosts="";
  URI tracker=new URI(config.tracker);
  JobClient client=new JobClient(new InetSocketAddress(tracker.getHost(),tracker.getPort()),conf);
  for (  String name : client.getClusterStatus(true).getActiveTrackerNames()) {
    String host=name.substring("tracker_".length(),name.indexOf(':'));
    hosts+=InetAddress.getAllByName(host)[0].getHostAddress() + ',';
  }
  conf.set(HOSTS_KEY,hosts);
  conf.set(PORT_KEY,"" + config.port);
  ToolRunner.run(conf,new HadoopTool(),args);
}
