{
  String version=Objects.firstNonNull(H2O.OPT_ARGS.hdfs_version,DEFAULT_HDFS_VERSION);
  if ("mapr".equals(version) || Strings.nullToEmpty(H2O.OPT_ARGS.hdfs).startsWith("maprsfs://")) {
    version=MAPRFS_HDFS_VERSION;
  }
  try {
    if (Boot._init.fromJar()) {
      File f=new File(version);
      if (f.exists()) {
        Boot._init.addExternalJars(f);
      }
 else {
        Boot._init.addInternalJars("hadoop/" + version + "/");
      }
    }
  }
 catch (  Exception e) {
    e.printStackTrace();
    Log.die("[hdfs] Unable to initialize hadoop version " + version + " please use different version.");
  }
  L.info(Sys.HDFS_,"Using HDFS version ",version);
  PersistHdfs.initialize();
}
