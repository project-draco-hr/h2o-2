{
  float coef=1;
  if (init != null) {
    float g=w[i] - init[i];
    boolean sign=g > 0;
    boolean last=mult[i] > 0;
    coef=Math.abs(mult[i]);
    if (sign == last) {
      if (coef < 4)       coef+=_perWeight;
    }
 else     coef*=1 - _perWeight;
    mult[i]=sign ? coef : -coef;
    w[i]=init[i] + coef * g;
  }
  if (prev != null) {
  }
  if (init != null)   init[i]=w[i];
}
