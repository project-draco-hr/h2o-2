{
  if (initial_weight_distribution == InitialWeightDistribution.UniformAdaptive) {
    final float range=prefactor * (float)Math.sqrt(6. / (_previous.units + units));
    for (int i=0; i < _w.length; i++)     _w[i]=(float)rand(rng,-range,range);
  }
 else {
    if (initial_weight_distribution == InitialWeightDistribution.Uniform) {
      for (int i=0; i < _w.length; i++) {
        _w[i]=(float)rand(rng,-initial_weight_scale,initial_weight_scale);
      }
    }
 else     if (initial_weight_distribution == InitialWeightDistribution.Normal) {
      for (int i=0; i < _w.length; i++) {
        _w[i]=(float)(0 + rng.nextGaussian() * initial_weight_scale);
      }
    }
  }
}
