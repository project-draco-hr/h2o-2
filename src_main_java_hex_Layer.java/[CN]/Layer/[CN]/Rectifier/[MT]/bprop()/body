{
  for (int o=0; o < _a.length; o++) {
    float g=_e[o];
    if (_a[o] < 0)     g=0;
    for (int i=0; i < _in._a.length; i++) {
      int w=o * _in._a.length + i;
      if (_in._e != null)       _in._e[i]+=g * _w[w];
      _w[w]+=_r * (g - _w[w] * _l2) * _in._a[i];
    }
    _b[o]+=_r * g;
  }
}
