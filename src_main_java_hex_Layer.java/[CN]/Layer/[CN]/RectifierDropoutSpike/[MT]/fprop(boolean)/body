{
  if (_rand == null) {
    _rand=new MersenneTwisterRNG(MersenneTwisterRNG.SEEDS);
  }
  for (int o=0; o < _a.length; o++) {
    _a[o]=0;
    for (int i=0; i < _previous._a.length; i++) {
      final double prob=_rand.nextDouble();
      if (_previous._a[i] <= prob) {
        _a[o]+=_w[o * _previous._a.length + i] * 0.5f;
      }
    }
    _a[o]+=_b[o];
    if (_a[o] < 0)     _a[o]=0;
 else     if (!training)     _a[o]*=.5f;
  }
}
