{
  long processed=_trainer.samples();
  float r=rate(processed);
  float m=momentum(processed);
  int label=target();
  for (int u=0; u < _a.length; u++) {
    float t=u == label ? 1 : 0;
    float e=t - _a[u];
    float g=e;
    if (loss == Loss.MeanSquare)     g*=(1 - _a[u]) * _a[u];
    bprop(u,g,r,m);
  }
}
