{
  int label=label();
  for (int o=0; o < _a.length; o++) {
    float t=o == label ? 1 : 0;
    float e=t - _a[o];
    float g=e * (1 - _a[o]) * _a[o];
    for (int i=0; i < _in._a.length; i++) {
      int w=o * _in._a.length + i;
      _in._e[i]+=g * _w[w];
      _w[w]+=_r * (g - _w[w] * _l2) * _in._a[i];
    }
    _b[o]+=_r * g;
  }
}
