{
  float max=Float.NEGATIVE_INFINITY;
  for (int o=0; o < _a.length; o++) {
    _a[o]=0;
    for (int i=0; i < _in._a.length; i++)     _a[o]+=_w[o * _in._a.length + i] * _in._a[i];
    _a[o]+=_b[o];
    if (max < _a[o])     max=_a[o];
  }
  float scale=0;
  for (int o=0; o < _a.length; o++) {
    _a[o]=(float)Math.exp(_a[o] - max);
    scale+=_a[o];
  }
  for (int o=0; o < _a.length; o++)   _a[o]/=scale;
}
