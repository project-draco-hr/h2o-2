{
  for (int o=0; o < _a.length; o++) {
    _a[o]=0;
    if (_rand == null)     _rand=new XorShiftRNG(123);
    if (!training || _rand.nextFloat() > dropout) {
      _a[o]=Float.NEGATIVE_INFINITY;
      for (int i=0; i < _in._a.length; i++)       _a[o]=Math.max(_a[o],_w[o * _in._a.length + i] * _in._a[i]);
      _a[o]+=_b[o];
      if (!training)       _a[o]*=1 - _in.dropout;
    }
  }
}
