{
  boolean id=true;
  final int[] colMap=columnMapping(ary.colNames());
  if (!isCompatible(colMap))   throw new IllegalArgumentException("This model uses different columns than those provided");
  int[][] catMap=new int[colMap.length][];
  for (int i=0; i < colMap.length - 1; ++i) {
    Column c=ary._cols[colMap[i]];
    if (c.isEnum() && !Arrays.deepEquals(_va._cols[i]._domain,c._domain)) {
      id=false;
      catMap[i]=new int[c._domain.length];
      for (int j=0; j < c._domain.length; ++j)       catMap[i][j]=find(c._domain[j],_va._cols[i]._domain);
    }
  }
  if (id && identityMap(colMap))   catMap=null;
  return new ModelDataAdaptor(this,colMap[colMap.length - 1],Arrays.copyOf(colMap,colMap.length - 1),catMap);
}
