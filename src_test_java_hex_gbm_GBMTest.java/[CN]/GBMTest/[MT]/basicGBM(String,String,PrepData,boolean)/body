{
  File file=TestUtil.find_test_file(fname);
  if (file == null)   return null;
  Key fkey=NFSFileVec.make(file);
  Key dest=Key.make(hexname);
  GBM gbm=null;
  GBM.GBMModel gbmmodel=null;
  try {
    gbm=new GBM();
    Frame fr=gbm.source=ParseDataset2.parse(dest,new Key[]{fkey});
    UKV.remove(fkey);
    int idx=prep.prep(fr);
    if (idx < 0) {
      gbm.classification=false;
      idx=~idx;
    }
    gbm.response=fr.vecs()[idx];
    gbm.ntrees=4;
    gbm.max_depth=4;
    gbm.min_rows=1;
    gbm.nbins=50;
    gbm.cols=new int[fr.numCols()];
    for (int i=0; i < gbm.cols.length; i++)     gbm.cols[i]=i;
    gbm.validation=validation ? new Frame(gbm.source) : null;
    gbm.learn_rate=.2f;
    gbm.invoke();
    gbmmodel=UKV.get(gbm.dest());
    Frame preds=gbm.score(gbm.source);
    preds.delete();
    return gbmmodel;
  }
  finally {
    gbm.source.delete();
    if (gbm.validation != null)     gbm.validation.delete();
    if (gbmmodel != null)     gbmmodel.delete();
    gbm.remove();
  }
}
