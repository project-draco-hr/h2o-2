{
  Map frameSummariesMap=new TreeMap();
  FrameSummary summary=new FrameSummary();
  Pair<Map<String,Model>,Map<String,Set<String>>> models_info=fetchModels();
  Map<String,Model> all_models=models_info.getFirst();
  Map<String,Set<String>> all_models_cols=models_info.getSecond();
  summarizeAndEnhanceFrame(summary,frame,this.find_compatible_models,all_models,all_models_cols);
  frameSummariesMap.put(frame._key.toString(),summary);
  Set<String> all_referenced_models=new TreeSet<String>();
  all_referenced_models.addAll(summary.compatible_models);
  Map resultsMap=new HashMap();
  resultsMap.put("frames",frameSummariesMap);
  if (this.find_compatible_models) {
    Map<String,ModelSummary> modelSummaries=Models.generateModelSummaries(all_referenced_models,all_models);
    resultsMap.put("models",modelSummaries);
  }
  String json=gson.toJson(resultsMap);
  JsonObject result=gson.fromJson(json,JsonElement.class).getAsJsonObject();
  return Response.done(result);
}
