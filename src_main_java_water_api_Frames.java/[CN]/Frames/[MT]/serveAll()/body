{
  Map<String,FrameSummary> frameSummariesMap=new TreeMap<String,FrameSummary>();
  Map<String,Frame> framesMap=fetchAll();
  Pair<Map<String,Model>,Map<String,Set<String>>> models_info=fetchModels();
  Map<String,Model> all_models=models_info.getFirst();
  Map<String,Set<String>> all_models_cols=models_info.getSecond();
  Set<String> all_referenced_models=new TreeSet<String>();
  for (  Map.Entry<String,Frame> entry : framesMap.entrySet()) {
    String keyString=entry.getKey();
    FrameSummary summary=new FrameSummary();
    Frame frame=entry.getValue();
    summarizeAndEnhanceFrame(summary,frame,this.find_compatible_models,all_models,all_models_cols);
    all_referenced_models.addAll(summary.compatible_models);
    frameSummariesMap.put(keyString,summary);
  }
  Map resultsMap=new HashMap();
  resultsMap.put("frames",frameSummariesMap);
  if (this.find_compatible_models) {
    Map<String,ModelSummary> modelSummaries=Models.generateModelSummaries(all_referenced_models,all_models);
    resultsMap.put("models",modelSummaries);
  }
  String json=gson.toJson(resultsMap);
  JsonObject result=gson.fromJson(json,JsonElement.class).getAsJsonObject();
  return Response.done(result);
}
