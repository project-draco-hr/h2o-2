{
  Object[] kvs=STORE.raw_array();
  ArrayList<KeyInfo> res=new ArrayList<KeyInfo>();
  for (int i=2; i < kvs.length; i+=2) {
    Object ok=kvs[i], ov=kvs[i + 1];
    if (!(ok instanceof Key))     continue;
    Key key=(Key)ok;
    if (homeOnly && !key.home())     continue;
    if (userOnly && !key.user_allowed())     continue;
    if (!(ov instanceof Value))     continue;
    Value value=(Value)ov;
    KeyInfo ki=new KeyInfo(key,value);
    if (f == null || f.filter(ki))     res.add(new KeyInfo(key,value));
  }
  return res.toArray(new KeyInfo[res.size()]);
}
