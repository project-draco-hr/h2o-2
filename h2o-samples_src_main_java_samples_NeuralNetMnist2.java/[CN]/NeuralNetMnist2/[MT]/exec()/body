{
  Log.info("Parsing data.");
  Frame trainf=TestUtil.parseFromH2OFolder("smalldata/mnist/train.csv");
  Frame testf=TestUtil.parseFromH2OFolder("smalldata/mnist/test.csv");
  Log.info("Done.");
  NN p=new NN();
  p.seed=0xC0FFEE;
  p.hidden=new int[]{128,128,256};
  p.rate=0.003;
  p.activation=NN.Activation.RectifierWithDropout;
  p.loss=NN.Loss.CrossEntropy;
  p.input_dropout_ratio=0.2;
  p.max_w2=15;
  p.epochs=200;
  p.rate_annealing=1e-6;
  p.l1=1e-5;
  p.l2=0;
  p.momentum_stable=0.99;
  p.momentum_start=0.5;
  p.momentum_ramp=1800000;
  p.initial_weight_distribution=NN.InitialWeightDistribution.UniformAdaptive;
  p.classification=true;
  p.diagnostics=false;
  p.validation=testf;
  p.source=trainf;
  p.response=trainf.lastVec();
  p.ignored_cols=null;
  p.destination_key=Key.make("mnist.model");
  p._dinfo=new FrameTask.DataInfo(FrameTask.DataInfo.prepareFrame(p.source,p.response,p.ignored_cols,true),1,true);
  return p.exec();
}
