{
  JsonObject json=new JsonObject();
  JsonArray succ=new JsonArray();
  JsonArray fail=new JsonArray();
  String bucket=_bucket.value();
  AmazonS3 s3=PersistS3.getClient();
  for (  S3ObjectSummary obj : s3.listObjects(bucket).getObjectSummaries()) {
    try {
      Key k=PersistS3.loadKey(obj);
      JsonObject o=new JsonObject();
      o.addProperty(KEY,k.toString());
      o.addProperty(FILE,obj.getKey());
      o.addProperty(VALUE_SIZE,obj.getSize());
      succ.add(o);
    }
 catch (    IOException e) {
      Log.err(e);
      JsonObject o=new JsonObject();
      o.addProperty(FILE,obj.getKey());
      o.addProperty(ERROR,e.getMessage());
      fail.add(o);
    }
  }
  json.add(NUM_SUCCEEDED,new JsonPrimitive(succ.size()));
  json.add(SUCCEEDED,succ);
  json.add(NUM_FAILED,new JsonPrimitive(fail.size()));
  json.add(FAILED,fail);
  DKV.write_barrier();
  Response r=Response.done(json);
  r.setBuilder(SUCCEEDED + "." + KEY,new KeyCellBuilder());
  return r;
}
