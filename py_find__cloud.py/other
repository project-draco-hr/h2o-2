import time, sys, json, re, getpass, requests
with open(flatfile_name(), 'r') as f:
    possMembers = f.readlines()
f.close()
h2oNodes = {}
probes = set()
tries = 0
for (n1, possMember) in enumerate(possMembers):
    tries += 1
    if (possMember not in probes):
        probes.add(possMember)
        members2 = probe_node(possMember, h2oNodes)
        for (n2, member2) in enumerate(members2):
            tries += 1
            if (member2 not in probes):
                probes.add(member2)
                probe_node(member2, h2oNodes)
print ('\nWe did %s tries' % tries)
print 'len(probe):', len(probes)
h2oNodesList = [v for (k, v) in h2oNodes.iteritems()]
expandedCloud = {'cloud_start': {'time': 'null', 'cwd': 'null', 'python_test_name': 'null', 'python_cmd_line': 'null', 'config_json': 'null', 'username': 'null', 'ip': 'null', }, 'h2oNodes': h2oNodesList, }
print 'Writing h2o-nodes.json'
with open('h2o-nodes.json', 'w+') as f:
    f.write(json.dumps(expandedCloud, indent=4))
