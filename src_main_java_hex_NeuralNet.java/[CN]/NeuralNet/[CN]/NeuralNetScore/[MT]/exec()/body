{
  Frame[] frs=model.adapt(source,false,true);
  int classes=model.layers[model.layers.length - 1]._units;
  confusion_matrix=new long[classes][classes];
  Error error=model.eval(frs[0],max_rows,confusion_matrix);
  classification_error=error.Value;
  sqr_error=error.SqrDist;
  if (frs[1] != null)   frs[1].remove();
}
