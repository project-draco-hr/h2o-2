{
  if (before == null)   throw new IllegalArgumentException("Missing frame to rebalance!");
  try {
    if (chunks > before.numRows())     throw new IllegalArgumentException("Cannot create more than " + before.numRows() + " chunks.");
    if (after == null)     after=before._key.toString() + ".balanced";
    final Key newKey=Key.make(after);
    RebalanceDataSet rb=new RebalanceDataSet(before,newKey,chunks);
    H2O.submitTask(rb);
    rb.join();
    return RequestBuilders.Response.done(this);
  }
 catch (  Throwable t) {
    return RequestBuilders.Response.error(t);
  }
}
