{
  double p=0;
  for (int i=0; i < data.length; i++) {
    int idx=_colCatMap[i];
    if (idx + 1 == _colCatMap[i + 1]) {
      double d=data[i];
      p+=_beta[idx] * d;
    }
 else {
      int d=(int)data[i];
      if (d == 0)       continue;
      if (d > 0 && (idx+=d) <= _colCatMap[i + 1])       p+=_beta[idx - 1];
 else       p=Double.NaN;
    }
  }
  p+=_beta[_beta.length - 1];
  double pp=_glmParams._link.linkInv(p);
  return pp;
}
