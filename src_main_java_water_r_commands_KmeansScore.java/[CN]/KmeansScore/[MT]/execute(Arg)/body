{
  Res res=defaultRes();
  ValueArray va=DKV.get(Key.make(arg.data)).get();
  KMeansModel model=DKV.get(Key.make(arg.model)).get();
  int colIds[]=model.columnMapping(va.colNames());
  if (!Model.isCompatible(colIds))   for (int i=0; i < colIds.length; i++)   if (colIds[i] == -1)   throw new IllegalArgumentException("Incompatible dataset: " + va._key + " does not have column '"+ model._va._cols[i]._name+ "'");
  try {
    if (!arg.classify) {
      KMeansModel.KMeansScore kms=KMeansModel.KMeansScore.score(model,va);
      res.result=kms._dist;
    }
 else {
      Key dest=Key.make(arg.data + ".mod");
      Job job=KMeansModel.KMeansApply.run(dest,model,va);
      job.get();
      res.destination=dest.toString();
    }
  }
 catch (  Error e) {
    res.error=e;
  }
  return res;
}
