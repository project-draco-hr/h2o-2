{
  for (int i=0; i < weights.length; ++i) {
    final double range=Math.sqrt(6. / (units[i] + units[i + 1]));
    for (int j=0; j < weights[i].length; j++) {
      if (parameters.initial_weight_distribution == NN.InitialWeightDistribution.UniformAdaptive) {
        weights[i][j]=(float)uniformDist(rng,-range,range);
      }
 else       if (parameters.initial_weight_distribution == NN.InitialWeightDistribution.Uniform) {
        weights[i][j]=(float)uniformDist(rng,-parameters.initial_weight_scale,parameters.initial_weight_scale);
      }
 else       if (parameters.initial_weight_distribution == NN.InitialWeightDistribution.Normal) {
        weights[i][j]=(float)(rng.nextGaussian() * parameters.initial_weight_scale);
      }
    }
  }
}
