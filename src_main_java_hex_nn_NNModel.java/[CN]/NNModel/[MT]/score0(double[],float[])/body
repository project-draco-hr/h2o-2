{
  Neurons[] neurons=NNTask.makeNeuronsForTesting(model_info);
  ((Neurons.Input)neurons[0]).setInput(-1,data);
  NNTask.step(-1,neurons,model_info,false,null);
  double[] out=neurons[neurons.length - 1]._a;
  assert((isClassifier() && preds.length == out.length + 1) || (!isClassifier() && preds.length == 1 && out.length == 1));
  for (int i=0; i < preds.length - 1; ++i)   preds[i + 1]=(float)out[i];
  preds[0]=getPrediction(preds,data);
  return preds;
}
