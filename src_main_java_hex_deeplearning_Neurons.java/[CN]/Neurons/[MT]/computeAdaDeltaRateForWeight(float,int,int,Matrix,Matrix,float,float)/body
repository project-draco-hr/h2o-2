{
  final float grad2=grad * grad;
  ada_g.set(row,col,ada_g.get(row,col) * rho);
  ada_g.add(row,col,(1f - rho) * grad2);
  final float RMS_dx=Utils.approxSqrt(ada_dx.get(row,col) + eps);
  final float invRMS_g=Utils.approxInvSqrt(ada_g.get(row,col) + eps);
  float rate=RMS_dx * invRMS_g;
  ada_dx.set(row,col,rho * ada_dx.get(row,col) + (1f - rho) * rate * rate* grad2);
  return rate;
}
