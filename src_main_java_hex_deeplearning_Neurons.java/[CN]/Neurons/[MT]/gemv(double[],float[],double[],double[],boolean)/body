{
  final int cols=x.length;
  final int rows=y.length;
  assert(res.length == rows);
  for (int r=0; r < rows; r++) {
    res[r]=0;
    if (!consider_dropout || _dropout == null || _dropout.unit_active(r)) {
      for (int i=0; i < cols; i++)       res[r]+=a[r * cols + i] * x[i];
      res[r]+=y[r];
    }
  }
}
