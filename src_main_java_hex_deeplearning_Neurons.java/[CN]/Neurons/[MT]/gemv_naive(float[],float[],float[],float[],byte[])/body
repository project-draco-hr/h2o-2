{
  final int cols=x.length;
  final int rows=y.length;
  assert(res.length == rows);
  for (int r=0; r < rows; r++) {
    res[r]=0;
    if (row_bits != null && (row_bits[r / 8] & (1 << (r % 8))) == 0)     continue;
    float tmp=0;
    for (int i=0; i < cols; i++)     tmp+=a[r * cols + i] * x[i];
    res[r]+=tmp + y[r];
  }
}
