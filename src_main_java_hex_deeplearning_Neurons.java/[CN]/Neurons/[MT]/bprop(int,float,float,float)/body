{
  if (params.fast_mode || (!_minfo.get_params().adaptive_rate && !_minfo.has_momenta() && params.l1 == 0.0 && params.l2 == 0.0)) {
    if (Math.abs(partial_grad) <= 1e-10)     return;
  }
  if (_w instanceof DenseRowMatrix)   bprop_dense_row_dense((DenseRowMatrix)_w,(DenseRowMatrix)_wm,_b,_bm,row,partial_grad,rate,momentum);
 else   throw new UnsupportedOperationException("bprop for types not yet implemented.");
}
