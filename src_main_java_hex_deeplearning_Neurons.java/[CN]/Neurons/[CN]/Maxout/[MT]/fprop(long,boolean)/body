{
  float max=0;
  for (int o=0; o < _a.size(); o++) {
    _a.set(o,0);
    if (!training || _dropout == null || _dropout.unit_active(o)) {
      _a.set(o,Float.NEGATIVE_INFINITY);
      for (int i=0; i < _previous._a.size(); i++)       _a.set(o,Math.max(_a.get(o),_w.get(o,i) * _previous._a.get(i)));
      _a.add(o,_b.get(o));
      max=Math.max(_a.get(o),max);
    }
  }
  if (max > 1)   Utils.div(_a.raw(),max);
}
