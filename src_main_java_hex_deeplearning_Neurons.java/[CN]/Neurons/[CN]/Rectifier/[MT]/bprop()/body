{
  final long processed=_minfo.get_processed_total();
  float m=momentum(processed);
  float r=rate(processed) * (1 - m);
  final int rows=_a.size();
  if (_w instanceof DenseRowMatrix) {
    for (int row=0; row < rows; row++) {
      float g=_a.get(row) > 0f ? _e.get(row) : 0f;
      g=autoEncoderError(g,row);
      bprop(row,g,r,m);
    }
  }
 else {
    bprop_sparse(r,m);
  }
}
