{
  long processed=_minfo.get_processed_total();
  final double m=momentum(processed);
  final double r=rate(processed) * (1 - m);
  for (int u=0; u < _a.length; u++) {
    if (params.fast_mode || (_wm == null && params.l1 == 0.0 && params.l2 == 0.0)) {
      if (_a[u] > 0) {
        final double g=_e[u];
        bprop(u,g,r,m);
      }
    }
 else {
      final double g=_a[u] > 0 ? _e[u] : 0;
      bprop(u,g,r,m);
    }
  }
}
