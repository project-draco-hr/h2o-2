{
  double g;
  for (int u=0; u < _a.length; u++) {
    final double t=(u == target ? 1 : 0);
    final double y=_a[u];
    if (params.loss == Loss.CrossEntropy) {
      g=t - y;
    }
 else {
      assert(params.loss == Loss.MeanSquare);
      g=(t - y) * (1 - y) * y;
    }
    bprop(u,g);
  }
}
