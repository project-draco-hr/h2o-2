{
  final long processed=_minfo.get_processed_total();
  float m=momentum(processed);
  float r=rate(processed) * (1 - m);
  float g;
  for (int u=0; u < _a.size(); u++) {
    final float t=(u == target ? 1 : 0);
    final float y=_a.get(u);
    if (params.loss == Loss.CrossEntropy) {
      g=t - y;
    }
 else {
      assert(params.loss == Loss.MeanSquare);
      g=(t - y) * (1 - y) * y;
    }
    bprop(u,g,r,m);
  }
}
