{
  if (source == null)   return RequestServer._http404.serve();
  if (cols == null) {
    cols=new int[Math.min(source.vecs().length,max_ncols)];
    for (int i=0; i < cols.length; i++)     cols[i]=i;
  }
  Vec[] vecs=new Vec[cols.length];
  String[] names=new String[cols.length];
  for (int i=0; i < cols.length; i++) {
    vecs[i]=source.vecs()[cols[i]];
    names[i]=source._names[cols[i]];
  }
  Frame fr=new Frame(names,vecs);
  Futures fs=new Futures();
  for (  Vec vec : vecs)   vec.rollupStats(fs);
  fs.blockForPending();
  Summary2.BasicSummaryTask basics=new Summary2.BasicSummaryTask().doAll(fr);
  double[] mins=basics._finite_min;
  double[] maxs=basics._finite_max;
  long time0=System.currentTimeMillis();
  long[] resample_idx=Summary2.resample_idx(fr.anyVec());
  Log.info("Generating resample indices takes " + (System.currentTimeMillis() - time0) + " milli sec.");
  time0=System.currentTimeMillis();
  summaries=new Summary2.SummaryTask2(mins,maxs,resample_idx).doAll(fr)._summaries;
  Log.info("Computing summary takes " + (System.currentTimeMillis() - time0) + " milli sec.");
  if (summaries != null)   for (int i=0; i < cols.length; i++)   summaries[i].finishUp(vecs[i]);
  return Response.done(this);
}
