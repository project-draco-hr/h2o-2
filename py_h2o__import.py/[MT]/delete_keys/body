def delete_keys(node=None, pattern=None, timeoutSecs=120):
    if (not node):
        node = h2o.nodes[0]
    kwargs = {'filter': pattern, }
    deletedCnt = 0
    while True:
        storeViewResult = h2o_cmd.runStoreView(node, timeoutSecs=timeoutSecs, **kwargs)
        keys = storeViewResult['keys']
        if (not keys):
            break
        for k in keys:
            node.remove_key(k['key'], timeoutSecs=timeoutSecs)
        deletedCnt += len(keys)
    return deletedCnt
