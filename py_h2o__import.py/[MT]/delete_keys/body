def delete_keys(node=None, pattern=None, timeoutSecs=120):
    if (not node):
        node = h2o.nodes[0]
    kwargs = {'filter': pattern, }
    deletedCnt = 0
    triedKeys = []
    while True:
        storeViewResult = h2o_cmd.runStoreView(node, timeoutSecs=timeoutSecs, **kwargs)
        keys = storeViewResult['keys']
        if (not keys):
            break
        for k in keys:
            if (k in triedKeys):
                print ('Already tried to delete %s. Must have failed. Not trying again' % k)
            else:
                node.remove_key(k['key'], timeoutSecs=timeoutSecs)
                deletedCnt += 1
            triedKeys.append(k)
    return deletedCnt
