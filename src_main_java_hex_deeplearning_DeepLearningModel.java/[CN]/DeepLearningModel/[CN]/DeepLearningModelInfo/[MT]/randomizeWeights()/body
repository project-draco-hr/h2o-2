{
  for (int w=0; w < weights.length; ++w) {
    final Random rng=water.util.Utils.getDeterRNG(get_params().seed + 0xBAD5EED + w+ 1);
    final double range=Math.sqrt(6. / (units[w] + units[w + 1]));
    for (int i=0; i < weights[w].rows(); i++) {
      for (int j=0; j < weights[w].cols(); j++) {
        if (parameters.initial_weight_distribution == DeepLearning.InitialWeightDistribution.UniformAdaptive) {
          if (w == weights.length - 1 && parameters.classification)           weights[w].set(i,j,(float)(4. * uniformDist(rng,-range,range)));
 else           weights[w].set(i,j,(float)uniformDist(rng,-range,range));
        }
 else         if (parameters.initial_weight_distribution == DeepLearning.InitialWeightDistribution.Uniform) {
          weights[w].set(i,j,(float)uniformDist(rng,-parameters.initial_weight_scale,parameters.initial_weight_scale));
        }
 else         if (parameters.initial_weight_distribution == DeepLearning.InitialWeightDistribution.Normal) {
          weights[w].set(i,j,(float)(rng.nextGaussian() * parameters.initial_weight_scale));
        }
      }
    }
  }
}
