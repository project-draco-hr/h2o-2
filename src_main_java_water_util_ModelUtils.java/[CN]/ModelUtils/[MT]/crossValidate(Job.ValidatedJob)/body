{
  if (job.validation != null)   throw new IllegalArgumentException("Cannot provide validation dataset and n_folds > 0 at the same time.");
  if (job.n_folds <= 1)   throw new IllegalArgumentException("n_folds must be >= 2 for cross-validation.");
  if (job.n_folds != 2)   throw new UnsupportedOperationException("n_folds != 2 is not yet implemented.");
  float[] ratios=TestUtil.arf(0.5f);
  final String basename=job.destination_key.toString();
  Key[] destkeys=new Key[]{Key.make(basename + ".cv" + ".first"),Key.make(basename + ".cv" + ".second")};
  FrameSplitter fs=new FrameSplitter(job.source,ratios,destkeys,null);
  H2O.submitTask(fs).join();
  Frame[] splits=fs.getResult();
  long[] offsets=new long[job.n_folds + 1];
  Frame[] cv_preds=new Frame[job.n_folds];
  for (int i=0; i < job.n_folds; ++i)   job.crossValidate(splits,cv_preds,offsets,i);
  if (!job.keep_cross_validation_splits)   for (  Frame f : splits)   f.delete();
  boolean put_back=UKV.get(job.response._key) == null;
  if (put_back)   DKV.put(job.response._key,job.response);
  ((Model)UKV.get(job.destination_key)).scoreCrossValidation(job,job.source,job.response,cv_preds,offsets);
  if (put_back)   UKV.remove(job.response._key);
}
