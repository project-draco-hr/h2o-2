{
  if (urlStr.startsWith("file://")) {
    urlStr=urlStr.substring("file://".length());
    File f=new File(urlStr);
    urlStr="file://" + f.getCanonicalPath();
  }
  URL url;
  try {
    url=new URL(urlStr);
  }
 catch (  MalformedURLException ex) {
    throw new Exception("Malformed url: " + urlStr);
  }
  if ((keyName == null) || keyName.isEmpty())   keyName=urlStr;
  try {
    Key.make(keyName);
  }
 catch (  IllegalArgumentException e) {
    throw new Exception("Not a valid key: " + keyName);
  }
  InputStream s=null;
  try {
    s=url.openStream();
    if (s == null)     throw new Exception("Unable to open stream to URL " + url.toString());
    Key result=ValueArray.readPut(keyName,s);
    return result;
  }
 catch (  IOException e) {
    throw new Exception(e.getMessage());
  }
 finally {
    Closeables.closeQuietly(s);
  }
}
