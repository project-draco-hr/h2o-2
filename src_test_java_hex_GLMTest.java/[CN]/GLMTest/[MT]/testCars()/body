{
  Key k=loadAndParseFile("h.hex","smalldata/cars.csv");
  ValueArray ary=DKV.get(k).get();
  try {
    String[] cfs1=new String[]{"Intercept","economy (mpg)","cylinders","displacement (cc)","weight (lb)","0-60 mph (s)","year"};
    int[] cols=ary.getColumnIds(new String[]{"economy (mpg)","cylinders","displacement (cc)","weight (lb)","0-60 mph (s)","year","power (hp)"});
    double[] vls1=new double[]{4.9504805,-0.0095859,-0.0063046,0.0004392,0.0001762,-0.0469810,0.0002891};
    DataFrame data=DGLM.getData(ary,cols,null,true);
    runGLMTest(data,new ADMMSolver(0,0),new GLMParams(Family.poisson),1,cfs1,vls1,Double.NaN,427.4,Double.NaN,2961,Double.NaN,1e-4,1e-1);
    runGLMTest(data,new GeneralizedGradientSolver(0,0),new GLMParams(Family.poisson),1,cfs1,vls1,Double.NaN,427.4,Double.NaN,2961,Double.NaN,1e-2,1e-1);
    double[] vls2=new double[]{8.992e-03,1.818e-04,-1.125e-04,1.505e-06,-1.284e-06,4.510e-04,-7.254e-05};
    runGLMTest(data,new ADMMSolver(0,0),new GLMParams(Family.gamma),1,cfs1,vls2,47.79,4.618,Double.NaN,Double.NaN,Double.NaN,1e-4,1e-1);
    runGLMTest(data,new GeneralizedGradientSolver(0,0),new GLMParams(Family.gamma),1,cfs1,vls2,47.79,4.618,Double.NaN,Double.NaN,Double.NaN,1e-4,1e-1);
    double[] vls3=new double[]{166.95862,-0.00531,-2.46690,0.12635,0.02159,-4.66995,-0.85724};
    runGLMTest(data,new ADMMSolver(0,0),new GLMParams(Family.gaussian),1,cfs1,vls3,Double.NaN,61640,Double.NaN,3111,Double.NaN,1e-3,5e-1);
    runGLMTest(data,new GeneralizedGradientSolver(0,0),new GLMParams(Family.gaussian),1,cfs1,vls3,Double.NaN,Double.NaN,Double.NaN,3111,Double.NaN,5e-1,5e-1);
  }
  finally {
    ary.delete();
  }
}
