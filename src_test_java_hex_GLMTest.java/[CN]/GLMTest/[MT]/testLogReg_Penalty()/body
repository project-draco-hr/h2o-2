{
  Key datakey=Key.make("datakey");
  try {
    ValueArray va=va_maker(datakey,2,10,new DataExpr(){
      public double expr(      byte[] x){
        return 1.0 / (1.0 + Math.exp(-(0.1 * x[0] + 0.3 * x[1] - 2.5)));
      }
    }
);
    LSMSolver lsms0=new ADMMSolver(0,0);
    JsonObject glm=computeGLMlog(lsms0,va);
    JsonObject coefs=glm.get("coefficients").getAsJsonObject();
    assertEquals(-2.5,coefs.get("Intercept").getAsDouble(),0.00001);
    assertEquals(0.1,coefs.get("C1").getAsDouble(),0.000001);
    assertEquals(0.3,coefs.get("C2").getAsDouble(),0.000001);
    UKV.remove(Key.make(glm.get(Constants.MODEL_KEY).getAsString()));
    LSMSolver lsms1=new ADMMSolver(0.0,0.0);
    glm=computeGLMlog(lsms1,va);
    coefs=glm.get("coefficients").getAsJsonObject();
    assertEquals(-2.5,coefs.get("Intercept").getAsDouble(),0.00001);
    assertEquals(0.1,coefs.get("C1").getAsDouble(),0.000001);
    assertEquals(0.3,coefs.get("C2").getAsDouble(),0.000001);
    UKV.remove(Key.make(glm.get(Constants.MODEL_KEY).getAsString()));
    LSMSolver lsms2=new ADMMSolver(0.0,0.0);
    glm=computeGLMlog(lsms2,va);
    coefs=glm.get("coefficients").getAsJsonObject();
    assertEquals(-2.5,coefs.get("Intercept").getAsDouble(),0.00001);
    assertEquals(0.1,coefs.get("C1").getAsDouble(),0.000001);
    assertEquals(0.3,coefs.get("C2").getAsDouble(),0.000001);
    UKV.remove(Key.make(glm.get(Constants.MODEL_KEY).getAsString()));
    LSMSolver lsmsx=new ADMMSolver(0.0,0.0);
    glm=computeGLMlog(lsmsx,va);
    coefs=glm.get("coefficients").getAsJsonObject();
    assertEquals(-2.5,coefs.get("Intercept").getAsDouble(),0.00001);
    assertEquals(0.1,coefs.get("C1").getAsDouble(),0.000001);
    assertEquals(0.3,coefs.get("C2").getAsDouble(),0.000001);
    UKV.remove(Key.make(glm.get(Constants.MODEL_KEY).getAsString()));
  }
  finally {
    UKV.remove(datakey);
  }
}
