{
  Field[] fields=api.getClass().getDeclaredFields();
  List<Field> fs=new ArrayList<Field>(fields.length);
  for (  Field f : fields) {
    f.setAccessible(true);
    API apiano=f.getAnnotation(API.class);
    if (apiano != null) {
      boolean add=false;
switch (apiano.direction()) {
case INOUT:
        add=true;
      break;
case IN:
    add=in;
  break;
case OUT:
add=!in;
break;
}
if (add) fs.add(f);
}
}
return fs.toArray(new Field[fs.size()]);
}
