def build_cloud(node_count=1, base_port=54321, hosts=None, timeoutSecs=30, retryDelaySecs=1, cleanup=True, conservative=False, **kwargs):
    clean_sandbox()
    log('#*********************************************************************')
    log((('Starting new test: ' + python_test_name) + ' at build_cloud()'))
    log('#*********************************************************************')
    if (getpass.getuser() == 'jenkins'):
        check_h2o_version()
    if kwargs.setdefault('enable_benchmark_log', False):
        setup_benchmark_log()
    ports_per_node = 2
    nodeList = []
    try:
        totalNodes = 0
        portList = [(base_port + (ports_per_node * i)) for i in range(node_count)]
        if (hosts is None):
            write_flatfile(node_count=node_count, base_port=base_port)
            hostCount = 1
            for p in portList:
                verboseprint('psutil starting node', i)
                newNode = LocalH2O(port=p, node_id=totalNodes, **kwargs)
                nodeList.append(newNode)
                totalNodes += 1
        else:
            hostCount = len(hosts)
            hostPortList = []
            for h in hosts:
                for port in portList:
                    hostPortList.append((h, port))
            for (h, p) in hostPortList:
                verboseprint('ssh starting node', totalNodes, 'via', h)
                newNode = h.remote_h2o(port=p, node_id=totalNodes, **kwargs)
                nodeList.append(newNode)
                totalNodes += 1
        verboseprint('Attempting Cloud stabilize of', totalNodes, 'nodes on', hostCount, 'hosts')
        start = time.time()
        stabilize_cloud(nodeList[0], len(nodeList), timeoutSecs=timeoutSecs, retryDelaySecs=retryDelaySecs, noExtraErrorCheck=True)
        verboseprint(len(nodeList), 'Last added node stabilized in ', (time.time() - start), ' secs')
        verboseprint(('Built cloud: %d nodes on %d hosts, in %d s' % (len(nodeList), hostCount, (time.time() - start))))
        h2p.red_print('Built cloud:', nodeList[0].java_heap_GB, 'GB java heap(s) with', len(nodeList), 'total nodes')
        if conservative:
            for n in nodeList:
                stabilize_cloud(n, len(nodeList), timeoutSecs=timeoutSecs, noExtraErrorCheck=True)
        verify_cloud_size(nodeList)
        check_sandbox_for_errors(python_test_name=python_test_name)
    except:
        if cleanup:
            for n in nodeList:
                n.terminate()
        else:
            nodes[:] = nodeList
        check_sandbox_for_errors(python_test_name=python_test_name)
        raise
    nodes[:] = nodeList
    print len(nodeList), 'total jvms in H2O cloud'
    nodes[0].h2o_log_msg()
    if config_json:
        print 'Saving the ', config_json, 'we used to', LOG_DIR
        shutil.copy(config_json, ((LOG_DIR + '/') + os.path.basename(config_json)))
    cs_time = str(datetime.datetime.now())
    cs_cwd = os.getcwd()
    cs_python_cmd_line = ('python %s %s' % (python_test_name, python_cmd_args))
    cs_python_test_name = python_test_name
    if config_json:
        cs_config_json = os.path.abspath(config_json)
    else:
        cs_config_json = None
    cs_username = python_username
    cs_ip = python_cmd_ip
    return nodeList
