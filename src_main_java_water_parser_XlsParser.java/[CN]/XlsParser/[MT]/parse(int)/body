{
  _firstRow=true;
  Value value=DKV.get(_key);
  InputStream is=null;
  if (value.type() != TypeMap.PRIM_B) {
    Object o=value.get();
    if (o instanceof ByteVec)     is=((ByteVec)o).openStream();
  }
  if (is == null)   is=value.openStream();
  try {
    _fs=new POIFSFileSystem(is);
    MissingRecordAwareHSSFListener listener=new MissingRecordAwareHSSFListener(this);
    _formatListener=new FormatTrackingHSSFListener(listener);
    HSSFEventFactory factory=new HSSFEventFactory();
    HSSFRequest request=new HSSFRequest();
    request.addListenerForAllRecords(_formatListener);
    factory.processWorkbookEvents(request,_fs);
  }
  finally {
    try {
      is.close();
    }
 catch (    IOException e) {
    }
  }
}
