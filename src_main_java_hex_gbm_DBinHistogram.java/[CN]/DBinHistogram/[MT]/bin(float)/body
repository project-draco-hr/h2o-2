{
  int idx1=_step <= 0.0 ? 0 : (int)((d - _bmin) / _step);
  int idx2=Math.max(Math.min(idx1,_nbins - 1),0);
  return idx2;
}
