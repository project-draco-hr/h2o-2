{
  int ridsz=vals.length >= 65535 ? 4 : 2;
  int elemsz=ridsz + 8;
  byte[] res=MemoryManager.malloc1(slen * elemsz + OFF);
  for (int i=0, off=OFF; i < slen; ++i, off+=elemsz) {
    int id=ids[i];
    if (elemsz == 2)     UDP.set2(res,off,(short)id);
 else     UDP.set4(res,off,id);
    UDP.set8d(res,off + ridsz,vals[id]);
  }
  return res;
}
