{
  client=CuratorFrameworkFactory.newClient(zkConnectionString,new ExponentialBackoffRetry(1000,3));
  client.start();
  ServiceInstanceBuilder<InstanceDetails> serviceInstanceBuilder;
  try {
    serviceInstanceBuilder=ServiceInstance.<InstanceDetails>builder().name(serviceName).payload(new InstanceDetails(description)).address(myAddress).port(port);
  }
 catch (  Exception e) {
    throw new RuntimeException("Exception while joining zookeeper",e);
  }
  if (uriSpec != null) {
    serviceInstanceBuilder.uriSpec(new UriSpec(uriSpec));
  }
  thisInstance=serviceInstanceBuilder.build();
  JsonInstanceSerializer<InstanceDetails> serializer=new JsonInstanceSerializer<InstanceDetails>(InstanceDetails.class);
  serviceDiscovery=ServiceDiscoveryBuilder.builder(InstanceDetails.class).client(client).basePath(path).serializer(serializer).thisInstance(thisInstance).build();
  if (autoStart) {
    start();
  }
}
