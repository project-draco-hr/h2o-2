{
  try {
    Collection<String> serviceNames=serviceDiscovery.queryForNames();
    if (serviceNames.isEmpty()) {
      throw new IllegalStateException("no nodes found ");
    }
    HashSet<H2ONode> nodes=Sets.newHashSet();
    for (    String serviceName : serviceNames) {
      Collection<ServiceInstance<InstanceDetails>> instances=serviceDiscovery.queryForInstances(serviceName);
      for (      ServiceInstance<InstanceDetails> instance : instances) {
        nodes.add(H2ONode.intern(InetAddress.getByName(instance.getAddress()),instance.getPort()));
      }
    }
    return nodes;
  }
 catch (  Exception e) {
    throw new RuntimeException("exception getting nodes list for this cloud",e);
  }
}
