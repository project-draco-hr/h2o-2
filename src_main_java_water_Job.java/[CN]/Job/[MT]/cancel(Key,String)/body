{
  DKV.remove(self);
  DKV.write_barrier();
  new TAtomic<List>(){
    transient private Job _job;
    @Override public List atomic(    List old){
      if (old == null)       old=new List();
      Job[] jobs=old._jobs;
      for (int i=0; i < jobs.length; i++) {
        if (jobs[i].job_key.equals(self)) {
          jobs[i].end_time=CANCELLED_END_TIME;
          System.out.println("setting end_time of " + jobs[i] + " to "+ jobs[i].end_time);
          jobs[i].exception=exception;
          _job=jobs[i];
          break;
        }
      }
      return old;
    }
    @Override public void onSuccess(){
      if (_job != null) {
        final Job job=_job;
        H2O.submitTask(new H2OCountedCompleter(){
          @Override public void compute2(){
            job.onCancelled();
          }
        }
);
      }
    }
  }
.invoke(LIST);
}
