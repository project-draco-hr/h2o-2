{
  long processed=_minfo.get_processed_total();
  double m=momentum(processed);
  double r=rate(processed);
  for (int u=0; u < _a.length; u++) {
    final double targetval=(u == target ? 1 : 0);
    double g=targetval - _a[u];
    if (loss == Loss.CrossEntropy) {
    }
 else     if (loss == Loss.MeanSquare) {
      g*=(1 - _a[u]) * _a[u];
    }
    bprop(u,g,r,m);
  }
}
