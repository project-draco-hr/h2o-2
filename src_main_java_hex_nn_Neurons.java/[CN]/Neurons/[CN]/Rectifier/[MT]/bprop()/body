{
  long processed=_minfo.get_processed();
  final double m=momentum(processed);
  final double r=rate(processed);
  for (int u=0; u < _a.length; u++) {
    if (_wm == null && l1 == 0.0 && l2 == 0.0) {
      if (_a[u] > 0) {
        final double g=_e[u];
        bprop(u,g,r,m);
      }
    }
 else {
      final double g=_a[u] > 0 ? _e[u] : 0;
      bprop(u,g,r,m);
    }
  }
}
