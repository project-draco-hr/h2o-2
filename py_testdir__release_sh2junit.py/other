import sys, psutil, os, tempfile, argparse, time
sys.path.extend(['.', '..', '../..', 'py'])
import h2o_sandbox
print 'Assumes ./sandbox already exists in current dir. Created by cloud building?'
if (__name__ == '__main__'):
    parser = argparse.ArgumentParser()
    parser.add_argument('-name', type=str, help='used to help name the xml/stdout/stderr logs created')
    parser.add_argument('-timeout', type=int, help='secs timeout for the shell subprocess. fail if timeout')
    parser.add_argument('-cmd', '--cmd_string', type=str, help='cmd string to pass to shell subprocess')
    parser.add_argument('rargs', nargs=argparse.REMAINDER)
    args = parser.parse_args()
    if args.name:
        name = args.name
    else:
        name = 'NoName'
    if args.cmd_string:
        cmd_string = args.cmd_string
    elif args.rargs:
        print 'args.rargs:', args.rargs
        if (args.rargs[0] == '--'):
            args.rargs[0] = ''
        cmd_string = ' '.join(args.rargs)
    else:
        cmd_string = '/bin/ls'
    sh2junit(name=name, cmd_string=cmd_string, timeout=args.timeout)
