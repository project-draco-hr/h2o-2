def upload_file(self, f, progress=None):
    f = find_file(f)
    if (f not in self.uploaded):
        start = time.time()
        import md5
        m = md5.new()
        m.update(open(f).read())
        m.update(getpass.getuser())
        dest = ((('/tmp/' + m.hexdigest()) + '-') + os.path.basename(f))
        sftp = self.ssh.open_sftp()
        try:
            try:
                sftp.stat(dest)
                print 'Skipping upload of file {0}. File {1} exists on remote side!'.format(f, dest)
            except IOError as e:
                if (e.errno == errno.ENOENT):
                    sftp.put(f, dest, callback=progress)
                    print '\n{0:.3f} seconds'.format((time.time() - start))
        finally:
            sftp.close()
        self.uploaded[f] = dest
    sys.stdout.flush()
    return self.uploaded[f]
