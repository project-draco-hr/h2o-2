def poll_url(self, response, timeoutSecs=10, retryDelaySecs=0.5, initialDelaySecs=0, pollTimeoutSecs=180, noise=None, benchmarkLogging=None, noPoll=False, reuseFirstPollUrl=False):
    verboseprint('poll_url input: response:', dump_json(response))

    def get_redirect_url(response, beta_features):
        url = None
        params = None
        if ('response_info' in response):
            response_info = response['response_info']
            if ('redirect_url' not in response_info):
                raise Exception(("Response during polling must have 'redirect_url'\n%s" % dump_json(response)))
            if (response_info['status'] == 'done'):
                pass
            else:
                redirect_url = response_info['redirect_url']
                if (('NeuralNetProgress' in str(redirect_url)) or ('KMeans2Progress' in str(redirect_url))):
                    if ('2/' not in str(redirect_url)):
                        redirect_url = ('2/' + redirect_url)
                if redirect_url:
                    url = self.__url(redirect_url)
                    params = None
                elif (response_info['status'] != 'done'):
                    raise Exception(("'redirect_url' during polling is null but status!='done': \n%s" % dump_json(response)))
        else:
            if ('response' not in response):
                raise Exception(("'response' not in response.\n%s" % dump_json(response)))
            if (response['response']['status'] == 'done'):
                pass
            else:
                if ('redirect_request' not in response['response']):
                    raise Exception(("'redirect_request' not in response. \n%s" % dump_json(response)))
                url = self.__url(response['response']['redirect_request'])
                params = response['response']['redirect_request_args']
        return (url, params)
    msgUsed = None
    if ('response_info' in response):
        status = response['response_info']['status']
        progress = response.get('progress', '')
    else:
        status = response['response']['status']
        progress = response['response'].get('progress', '')
    firstPoll = (status != 'done')
    (url, params) = get_redirect_url(response, beta_features)
    if params:
        paramsStr = '&'.join([('%s=%s' % (k, v)) for (k, v) in params.items()])
    else:
        paramsStr = ''
    noise_enable = ((noise is not None) and (noise != ('JStack', None)))
    if noise_enable:
        print 'Using noise during poll_url:', noise
        (noise_json, noiseParams) = noise
        noiseUrl = self.__url((noise_json + '.json'))
        if (noiseParams is None):
            noiseParamsStr = ''
        else:
            noiseParamsStr = '&'.join([('%s=%s' % (k, v)) for (k, v) in noiseParams.items()])
    start = time.time()
    count = 0
    if initialDelaySecs:
        time.sleep(initialDelaySecs)
    while ((status == 'poll') or firstPoll or (beta_features and (status == 'redirect') and ('Inspect' not in url))):
        firstPoll = False
        print status, progress, url
        time.sleep(retryDelaySecs)
        create_noise = (noise_enable and ((count % 2) == 0))
        if create_noise:
            urlUsed = noiseUrl
            paramsUsed = noiseParams
            paramsUsedStr = noiseParamsStr
            msgUsed = '\nNoise during polling with'
        else:
            urlUsed = url
            paramsUsed = params
            paramsUsedStr = paramsStr
            msgUsed = '\nPolling with'
        response = self.__do_json_request(fullUrl=urlUsed, timeout=pollTimeoutSecs, params=paramsUsed)
        verboseprint(msgUsed, urlUsed, paramsUsedStr, 'Response:', dump_json(response))
        if ((count % 6) == 0):
            check_sandbox_for_errors()
        if create_noise:
            progress = ''
        else:
            if ('response_info' in response):
                status = response['response_info']['status']
                progress = response.get('progress', '')
            else:
                status = response['response']['status']
                progress = response['response'].get('progress', '')
            if (beta_features and (not reuseFirstPollUrl)):
                (url, params) = get_redirect_url(response, beta_features)
        if ((time.time() - start) > timeoutSecs):
            emsg = (('Exceeded timeoutSecs: %d secs while polling.' % timeoutSecs) + ('status: %s, url: %s?%s' % (status, urlUsed, paramsUsedStr)))
            raise Exception(emsg)
        count += 1
        if noPoll:
            return response
        if benchmarkLogging:
            cloudPerfH2O.get_log_save(benchmarkLogging)
    if msgUsed:
        verboseprint(msgUsed, urlUsed, paramsUsedStr, 'Response:', dump_json(response))
    return response
