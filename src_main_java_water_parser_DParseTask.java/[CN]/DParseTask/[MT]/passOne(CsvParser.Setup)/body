{
  _setup=setup;
switch (_parserType) {
case CSV:
    if (setup == null) {
      byte[] bits=_sourceDataset.getFirstBytes();
      setup=CsvParser.guessCsvSetup(bits);
    }
  if (setup._data == null) {
    _error="Unable to determine the separator or number of columns on the dataset";
    throw new Error(_error);
  }
_colNames=setup._data[0];
setColumnNames(_colNames);
_skip=setup._header;
this._sep=setup._separator;
if (_sourceDataset.isArray()) {
ValueArray ary=_sourceDataset.get();
_nrows=new long[(int)ary.chunks() + 1];
}
 else _nrows=new long[2];
dfork(_sourceDataset._key);
break;
case XLS:
try {
XlsParser p=new XlsParser(this,_sourceDataset._key);
Log.info("parsing ",_sourceDataset._key);
p.parse(0);
--_myrows;
_numRows=_myrows;
}
 catch (Exception e) {
throw new RuntimeException(e);
}
break;
case XLSX:
default :
throw H2O.unimpl();
}
}
