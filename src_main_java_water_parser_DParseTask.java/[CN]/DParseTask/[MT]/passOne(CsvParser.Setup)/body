{
switch (_parserType) {
case CSV:
    if (setup == null) {
      byte[] bits=_sourceDataset.getFirstBytes();
      setup=CsvParser.guessCsvSetup(bits);
    }
  if (setup._data == null) {
    _error="Unable to determine the separator or number of columns on the dataset";
    return;
  }
_colNames=setup._data[0];
setColumnNames(_colNames);
_skipFirstLine=setup._header;
this._sep=setup._separator;
if (_sourceDataset.isArray()) {
ValueArray ary=_sourceDataset.get();
_nrows=new int[(int)ary.chunks()];
}
 else _nrows=new int[1];
this.invoke(_sourceDataset._key);
break;
case XLS:
CustomParser p=new XlsParser(this);
p.parse(_sourceDataset._key);
--_myrows;
break;
case XLSX:
CustomParser px=new XlsxParser(this);
px.parse(_sourceDataset._key);
break;
default :
throw new Error("NOT IMPLEMENTED");
}
}
