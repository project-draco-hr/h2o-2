{
switch (_parserType) {
case CSV:
    byte[] bits=_sourceDataset.getFirstBytes();
  if (setup == null)   setup=CsvParser.guessCsvSetup(bits);
if (setup._data == null) {
  _error="Unable to determine the separator or number of columns on the dataset";
  return;
}
_colNames=setup._data[0];
setColumnNames(_colNames);
_skipFirstLine=setup._header;
this._sep=setup._separator;
if (_sourceDataset.isArray()) {
ValueArray ary=ValueArray.value(_sourceDataset);
_nrows=new int[(int)ary.chunks()];
}
this.invoke(_sourceDataset._key);
break;
case XLS:
CustomParser p=new XlsParser(this);
p.parse(_sourceDataset._key);
--_myrows;
break;
case XLSX:
CustomParser px=new XlsxParser(this);
px.parse(_sourceDataset._key);
break;
default :
throw new Error("NOT IMPLEMENTED");
}
if (_nrows != null) {
_numRows=0;
for (int i=0; i < _nrows.length; ++i) {
_numRows+=_nrows[i];
_nrows[i]=_numRows;
}
}
 else {
_numRows=_myrows;
}
for (int i=0; i < _ncolumns; ++i) _mean[i]=_mean[i] / (_numRows - _invalidValues[i]);
}
