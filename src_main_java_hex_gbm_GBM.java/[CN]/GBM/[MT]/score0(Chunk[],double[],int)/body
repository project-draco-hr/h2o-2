{
  if (_nclass == 1)   return chk_tree(chks,0).at0(row);
  if (_nclass == 2) {
    ds[0]=Math.exp(chk_tree(chks,0).at0(row));
    ds[1]=1.0 / ds[0];
    return ds[0] + ds[1];
  }
  double sum=0;
  for (int k=0; k < _nclass; k++)   sum+=(ds[k]=Math.exp(chk_tree(chks,k).at0(row)));
  return sum;
}
