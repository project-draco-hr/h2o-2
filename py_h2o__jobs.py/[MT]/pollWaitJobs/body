def pollWaitJobs(pattern=None, timeoutSecs=30, pollTimeoutSecs=30, retryDelaySecs=5, benchmarkLogging=None, stallForNJobs=None):
    wait = True
    waitTime = 0
    ignoredJobs = set()
    while wait:
        a = h2o.nodes[0].jobs_admin(timeoutSecs=pollTimeoutSecs)
        jobs = a['jobs']
        busy = 0
        for j in jobs:
            if (j['end_time'] == ''):
                if (not pattern):
                    print 'description:', j['description'], 'end_time:', j['end_time']
                    busy += 1
                    h2o.verboseprint(('pollWaitJobs: found a busy job, now: %s' % busy))
                elif ((pattern in j['key']) or (pattern in j['destination_key']) or (pattern in j['description'])):
                    print 'description:', j['description'], 'end_time:', j['end_time']
                    busy += 1
                    h2o.verboseprint(('pollWaitJobs: found a pattern-matched busy job, now %s' % busy))
                elif (j['key'] not in ignoredJobs):
                    jobMsg = ('%s %s %s' % (j['key'], j['description'], j['destination_key']))
                    print (" %s job in progress but we're ignoring it. Doesn't match pattern." % jobMsg)
                    ignoredJobs.add(j['key'])
            elif waitTime:
                h2o.verboseprint('waiting', waitTime, 'secs, still not done - ', 'destination_key:', j['destination_key'], 'progress:', j['progress'], 'cancelled:', j['cancelled'], 'end_time:', j['end_time'])
        if stallForNJobs:
            waitFor = stallForNJobs
        else:
            waitFor = 0
        print (' %s jobs in progress.' % busy), ('Waiting until %s in progress.' % waitFor)
        wait = (busy > waitFor)
        if (not wait):
            break
        if (wait and (waitTime > timeoutSecs)):
            print h2o.dump_json(jobs)
            raise Exception("Some queued jobs haven't completed after", timeoutSecs, 'seconds')
        sys.stdout.write('.')
        sys.stdout.flush()
        time.sleep(retryDelaySecs)
        waitTime += retryDelaySecs
        if benchmarkLogging:
            h2o.cloudPerfH2O.get_log_save(benchmarkLogging)
        h2o.check_sandbox_for_errors()
    patternKeys = []
    for j in jobs:
        if (pattern and (pattern in j['destination_key'])):
            patternKeys.append(j['destination_key'])
    return patternKeys
