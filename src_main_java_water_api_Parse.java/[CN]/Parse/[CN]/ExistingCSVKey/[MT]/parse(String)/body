{
  Pattern p=makePattern(input);
  Pattern exclude=null;
  if (_hdrFrom.specified())   _header.setValue(true);
  if (_excludeExpression.specified())   exclude=makePattern(_excludeExpression.value());
  ArrayList<Key> keys=new ArrayList();
  for (  Key key : H2O.localKeySet()) {
    if (!key.user_allowed())     continue;
    String ks=key.toString();
    if (!p.matcher(ks).matches())     continue;
    if (exclude != null && exclude.matcher(ks).matches())     continue;
    Value v2=DKV.get(key);
    if (!v2.isRawData())     continue;
    keys.add(key);
  }
  if (keys.size() == 0)   throw new IllegalArgumentException("I did not find any keys matching this pattern!");
  Collections.sort(keys);
  Key hKey=null;
  if (_hdrFrom.specified()) {
    hKey=_hdrFrom.value()._key;
    _header.setValue(true);
  }
  boolean checkHeader=!_header.specified();
  boolean hasHeader=_header.value();
  try {
    CustomParser.PSetupGuess setup=ParseDataset.guessSetup(keys,hKey,new CustomParser.ParserSetup(_parserType.value(),_separator.value(),hasHeader),checkHeader);
    if (setup._hdrFromFile != null)     _hdrFrom.setValue(DKV.get(setup._hdrFromFile));
    if (!_header.specified())     _header.setValue(setup._setup._header);
 else     setup._setup._header=_header.value();
    if (!_header.value())     _hdrFrom.disable("Header is disabled.");
    PSetup res=new PSetup(keys,null,setup);
    _parserType.setValue(setup._setup._pType);
    _separator.setValue(setup._setup._separator);
    _hdrFrom._hideInQuery=_header._hideInQuery=_separator._hideInQuery=setup._setup._pType != CustomParser.ParserType.CSV;
    setup.checkColumnNames();
    return res;
  }
 catch (  ParseSetupGuessException e) {
    if (e._gSetup != null)     record()._value=new PSetup(keys,e._failed,e._gSetup);
    throw new IllegalArgumentException(e.getMessage());
  }
}
