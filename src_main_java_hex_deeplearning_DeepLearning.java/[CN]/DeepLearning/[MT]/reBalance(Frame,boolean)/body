{
  int cores=0;
  for (  H2ONode node : H2O.CLOUD._memary) {
    if (local)     cores=Math.max(cores,node._heartbeat._num_cpus);
 else     cores+=node._heartbeat._num_cpus;
  }
  final int chunks=4 * cores;
  if (force_load_balance && chunks < fr.numRows()) {
    Log.info("Starting load balancing into (at least) " + chunks + " chunks.");
    Key newKey=fr._key != null ? Key.make(fr._key.toString() + ".balanced") : Key.make();
    RebalanceDataSet rb=new RebalanceDataSet(fr,newKey,chunks);
    H2O.submitTask(rb);
    rb.join();
    Frame rebalanced=UKV.get(newKey);
    Log.info("Load balancing done.");
    return rebalanced;
  }
 else   return fr;
}
