{
  int i=0;
  Random rng=new Random(0xa7a34721109d3708L ^ System.currentTimeMillis());
  try {
    for (i=0; i < 50000; ++i) {
      UKV.put(Key.make("key" + i),new Utils.IcedInt(i));
      if (i % (rng.nextInt(31) + 1) == 0) {
        Key[] keys2=H2O.KeySnapshot.globalSnapshot().keys();
        Assert.assertEquals(i + 1,keys2.length);
      }
    }
  }
  finally {
    Futures fs=new Futures();
    for (int j=0; j < i; ++j) {
      DKV.remove(Key.make("key" + j),fs);
    }
    fs.blockForPending();
  }
}
